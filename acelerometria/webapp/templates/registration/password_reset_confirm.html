{% extends 'master.html' %}

{% block title %}
  <title>Set new password</title>
{% endblock %}

{% block content %}
<main class="mainRegister">
  <div class="container">
    <div class="form-box">
      <h2>Set a new password</h2>

      {% if validlink %}
        {# Inline errors from the form itself #}
        {% if form.errors %}
            <ul style="color: red;">
            {% for field in form %}
                {% for error in field.errors %}
                <li>{{ error }}</li>
                {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
            {% endfor %}
            </ul>
        {% endif %}

        {# Display any messages (e.g. success, error) #}
        {% if messages %}
          {% for msg in messages %}
            {% if 'inline' in msg.tags %}
              <p style="color: red;">{{ msg }}</p>
            {% endif %}
          {% endfor %}
        {% endif %}
        <form class="password_change" method="post">
          {% csrf_token %}

          <label for="{{ form.new_password1.id_for_label }}">
            {{ form.new_password1.label }}:
          </label><br>
          {{ form.new_password1 }}<br>
            <small class="help-text">{{ form.new_password1.help_text }}</small>
          <br><br>

          <label for="{{ form.new_password2.id_for_label }}">
            {{ form.new_password2.label }}:
          </label><br>
          {{ form.new_password2 }}<br>
            <small class="help-text">{{ form.new_password2.help_text }}</small>
          <br>

          <button type="submit">Reset password</button>
        </form>
      {% else %}
        <p>
          The password reset link is invalid, possibly because it has already been used or expired. Please try again.
        </p>
      {% endif %}
    </div>
  </div>
</main>
{% endblock %}
